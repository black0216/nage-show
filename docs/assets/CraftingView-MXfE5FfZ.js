import{d as P,r as v,q as j,o as z,a as O,s as p,v as F,c as i,e as s,x as R,y as U,b as k,F as G,m as H,t as y,n as B,g as T,p as A,f as r}from"./vendor-ByJcA75B.js";import{I as S}from"./ItemTooltip-CT6rXn5Y.js";import{_ as J}from"./index-CpS1CKNR.js";const K={class:"crafting-view"},Q={class:"filters"},W={class:"crafting-container"},Z={class:"materials-section"},ee={class:"materials-grid"},te={class:"material-container"},se=["onMouseenter","onMouseleave"],ae=["alt"],le={class:"item-name-label"},ne={class:"material-container"},oe=["onMouseenter","onMouseleave"],ie=["alt"],re={class:"item-name-label"},ue={class:"material-container"},me=["onMouseenter","onMouseleave"],ve=["alt"],de={class:"item-name-label"},ce={class:"result-section"},ge={class:"result-container"},fe=["onMouseenter","onMouseleave"],Ie=["alt"],he={class:"item-name-label"},_e={key:0,class:"infinite-scroll-trigger",style:{height:"1px",width:"100%"}},we={key:1,class:"loading-indicator"},ye={key:2,class:"no-more"},be={key:3,class:"no-results"},Ce={key:0},Me={key:1},x=20,pe=P({__name:"CraftingView",setup(ke){let g=[];const d=v([]),o=v(""),f=v(null),I=v(""),h=v(null),N=v(1),_=v(!1),c=v(!0),L=async()=>{if(!(g.length>0))try{g=await(await fetch("/Crafting.json")).json()}catch(a){console.error("Failed to load all crafting data:",a)}},b=async(a=!1)=>{if(!_.value){_.value=!0;try{(a||d.value.length===0)&&(await L(),d.value=[],N.value=1,c.value=!0);const t=(N.value-1)*x,e=t+x,l=g.slice(t,e);a?d.value=l:d.value=[...d.value,...l],N.value++,c.value=e<g.length}catch(t){console.error("Failed to load crafting data:",t)}finally{_.value=!1}}},$=j(()=>o.value?g.filter(a=>{const t=o.value.toLowerCase();return a.Item.Name.toLowerCase().includes(t)||a.ItemA.Name.toLowerCase().includes(t)||a.ItemB.Name.toLowerCase().includes(t)||a.ItemC.Name.toLowerCase().includes(t)}):d.value);let q;const E=a=>{clearTimeout(q),q=setTimeout(async()=>{a?g.length===0&&await b(!0):(await b(!0),await p(),M())},300)},C=(a,t,e)=>{const n=`/images/${a.toLowerCase()}.jpg`,D=32,X=-(e-1)*D,Y=-(t-1)*D;return{width:"32px",height:"32px",backgroundImage:`url(${n})`,backgroundPosition:`${X}px ${Y}px`,backgroundSize:"256px 256px",backgroundRepeat:"no-repeat"}},w=(a,t,e)=>{const l=`${a.Name}_${a.Sheet}_${a.X}_${a.Y}_${a.Type}`;return t!==void 0&&e!==void 0?`${l}_${t}_${e}`:l},u=(a,t,e,l,n)=>{l&&n?.currentTarget?(f.value=a,I.value=w(a,t,e),h.value=n.currentTarget):(f.value=null,I.value="",h.value=null)};z(async()=>{await L(),b(!0),V()});let m=null;const V=()=>{m=new IntersectionObserver(a=>{a.forEach(t=>{t.isIntersecting&&c.value&&!_.value&&!o.value&&b()})},{root:null,rootMargin:"200px",threshold:.1}),M(),O(()=>{m&&m.disconnect()})},M=()=>{m&&(m.disconnect(),p(()=>{if(m&&!o.value&&c.value){const a=document.querySelector(".infinite-scroll-trigger");a&&m.observe(a);const t=document.querySelector(".crafting-item:last-child");t&&m.observe(t)}}))};return F(()=>d.value.length,async()=>{await p(),M()}),F(()=>o.value,async(a,t)=>{t&&!a&&(await p(),M())}),(a,t)=>(r(),i("div",K,[t[10]||(t[10]=s("h1",null,"合成表",-1)),s("div",Q,[R(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),onInput:t[1]||(t[1]=e=>E(o.value)),type:"text",placeholder:"搜索道具名称...",class:"search-input"},null,544),[[U,o.value]])]),s("div",W,[(r(!0),i(G,null,H($.value,(e,l)=>(r(),i("div",{key:l,class:"crafting-item"},[s("div",Z,[t[5]||(t[5]=s("div",{class:"section-title"},"合成材料",-1)),s("div",ee,[s("div",te,[t[2]||(t[2]=s("div",{class:"slot-label"},"A槽",-1)),s("div",{class:B(["item-wrapper",{equipment:e.ItemA.Type===3,gift:e.ItemA.Type===2}]),onMouseenter:n=>u(e.ItemA,l,"A",!0,n),onMouseleave:n=>u(e.ItemA,l,"A",!1,n)},[s("div",{class:"item-icon",style:A(C(e.ItemA.Sheet,e.ItemA.X,e.ItemA.Y)),alt:e.ItemA.Name},null,12,ae),s("div",le,y(e.ItemA.Name),1),T(S,{item:f.value,visible:I.value===w(e.ItemA,l,"A"),"trigger-element":h.value},null,8,["item","visible","trigger-element"])],42,se)]),s("div",ne,[t[3]||(t[3]=s("div",{class:"slot-label"},"B槽",-1)),s("div",{class:B(["item-wrapper",{equipment:e.ItemB.Type===3,gift:e.ItemB.Type===2}]),onMouseenter:n=>u(e.ItemB,l,"B",!0,n),onMouseleave:n=>u(e.ItemB,l,"B",!1,n)},[s("div",{class:"item-icon",style:A(C(e.ItemB.Sheet,e.ItemB.X,e.ItemB.Y)),alt:e.ItemB.Name},null,12,ie),s("div",re,y(e.ItemB.Name),1),T(S,{item:f.value,visible:I.value===w(e.ItemB,l,"B"),"trigger-element":h.value},null,8,["item","visible","trigger-element"])],42,oe)]),s("div",ue,[t[4]||(t[4]=s("div",{class:"slot-label"},"C槽",-1)),s("div",{class:B(["item-wrapper",{equipment:e.ItemC.Type===3,gift:e.ItemC.Type===2}]),onMouseenter:n=>u(e.ItemC,l,"C",!0,n),onMouseleave:n=>u(e.ItemC,l,"C",!1,n)},[s("div",{class:"item-icon",style:A(C(e.ItemC.Sheet,e.ItemC.X,e.ItemC.Y)),alt:e.ItemC.Name},null,12,ve),s("div",de,y(e.ItemC.Name),1),T(S,{item:f.value,visible:I.value===w(e.ItemC,l,"C"),"trigger-element":h.value},null,8,["item","visible","trigger-element"])],42,me)])])]),t[7]||(t[7]=s("div",{class:"crafting-arrow"},[s("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M20 8L32 20L20 32",stroke:"#ffd700","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),s("div",ce,[t[6]||(t[6]=s("div",{class:"section-title"},"合成结果",-1)),s("div",ge,[s("div",{class:B(["item-wrapper",{equipment:e.Item.Type===3,gift:e.Item.Type===2}]),onMouseenter:n=>u(e.Item,l,"Final",!0,n),onMouseleave:n=>u(e.Item,l,"Final",!1,n)},[s("div",{class:"item-icon result-icon",style:A(C(e.Item.Sheet,e.Item.X,e.Item.Y)),alt:e.Item.Name},null,12,Ie),s("div",he,y(e.Item.Name),1),T(S,{item:f.value,visible:I.value===w(e.Item,l,"Final"),"trigger-element":h.value},null,8,["item","visible","trigger-element"])],42,fe)])])]))),128)),!o.value&&c.value?(r(),i("div",_e)):k("",!0),!o.value&&c.value&&_.value?(r(),i("div",we,[...t[8]||(t[8]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"加载更多...",-1)])])):k("",!0),!o.value&&!c.value&&$.value.length>0?(r(),i("div",ye,[...t[9]||(t[9]=[s("span",null,"已加载全部数据",-1)])])):k("",!0),$.value.length===0&&!_.value?(r(),i("div",be,[o.value?(r(),i("p",Ce,'未找到 "'+y(o.value)+'" 相关的合成配方',1)):(r(),i("p",Me,"暂无数据"))])):k("",!0)])]))}}),Se=J(pe,[["__scopeId","data-v-bbf28bfb"]]);export{Se as default};
