import{d as V,r as p,b as j,e as z,f as G,n as L,w as q,c as o,g as n,h as B,v as F,i as g,F as T,j as b,t as f,o as a,k as M,l as O,_ as R}from"./index-CnIZBKMO.js";const U={class:"drops-view"},X={class:"filters"},Y={class:"drops-container"},A={class:"monster-name"},W={class:"items-grid"},H=["onMouseenter"],J=["alt"],K={class:"item-name-label"},Q={class:"tooltip-header"},Z={class:"item-name"},ee={class:"item-type"},te={key:0,class:"gift-contents"},se={class:"gift-items"},ne={class:"gift-item-name"},oe={key:0,class:"infinite-scroll-trigger",style:{height:"1px",width:"100%"}},ae={key:1,class:"loading-indicator"},le={key:2,class:"no-more"},re={key:3,class:"no-results"},ie={key:0},ue={key:1},N=20,ce=V({__name:"DropsView",setup(de){let y=[];const i=p([]),l=p(""),k=p(null),x=p(1),c=p(!1),d=p(!0),m=async(t=!1)=>{if(!c.value){c.value=!0;try{if(t||i.value.length===0){const v=await(await fetch("/Drops.json")).json();i.value=[],x.value=1,d.value=!0,y=v}const e=(x.value-1)*N,r=e+N,h=y.slice(e,r);t?i.value=h:i.value=[...i.value,...h],x.value++,d.value=r<y.length}catch(e){console.error("Failed to load drops data:",e)}finally{c.value=!1}}},I=j(()=>l.value?i.value.filter(t=>t.NpcName.toLowerCase().includes(l.value.toLowerCase())):i.value);let S;const $=t=>{clearTimeout(S),S=setTimeout(()=>{m(!0)},300)},C=(t,e,r)=>{const s=`/images/${t.startsWith("Item")?t:`Item${t.substring(t.length-2)}`}.jpg`,v=32,_=-(r-1)*v,w=-(e-1)*v;return{width:"32px",height:"32px",backgroundImage:`url(${s})`,backgroundPosition:`${_}px ${w}px`,backgroundSize:"256px 256px",backgroundRepeat:"no-repeat"}},E=t=>{switch(t){case 1:return"普通道具";case 2:return"礼包";case 3:return"装备";default:return"未知"}};z(()=>{m(!0),P()});let u=null;const P=()=>{u=new IntersectionObserver(t=>{t.forEach(e=>{e.isIntersecting&&d.value&&!c.value&&!l.value&&m()})},{root:null,rootMargin:"200px",threshold:.1}),D(),G(()=>{u&&u.disconnect()})},D=()=>{u&&(u.disconnect(),L(()=>{if(!u)return;const t=document.querySelector(".infinite-scroll-trigger");t&&u.observe(t);const e=document.querySelector(".drop-item:last-child");e&&u.observe(e)}))};return q(()=>i.value.length,()=>{D()}),(t,e)=>(a(),o("div",U,[e[6]||(e[6]=n("h1",null,"掉落表",-1)),n("div",X,[B(n("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.value=r),onInput:e[1]||(e[1]=r=>$(l.value)),type:"text",placeholder:"搜索怪物名称...",class:"search-input"},null,544),[[F,l.value]])]),n("div",Y,[(a(!0),o(T,null,b(I.value,(r,h)=>(a(),o("div",{key:h,class:"drop-item"},[n("div",A,f(r.NpcName),1),n("div",W,[(a(!0),o(T,null,b(r.DropItems,(s,v)=>(a(),o("div",{key:v,class:M(["item-container",{equipment:s.Type===3,gift:s.Type===2}])},[n("div",{class:"item-wrapper",onMouseenter:_=>k.value=s,onMouseleave:e[2]||(e[2]=_=>k.value=null)},[n("div",{class:"item-icon",style:O(C(s.Sheet,s.X,s.Y)),alt:s.Name},null,12,J),n("div",K,f(s.Name),1)],40,H),k.value===s?(a(),o("div",{key:0,class:M(["tooltip",{"gift-tooltip":s.Type===2}])},[n("div",Q,[n("span",Z,f(s.Name),1),n("span",ee,f(E(s.Type)),1)]),s.Type===2&&s.Gifts&&s.Gifts.length>0?(a(),o("div",te,[e[3]||(e[3]=n("div",{class:"gift-title"},"礼包内容：",-1)),n("div",se,[(a(!0),o(T,null,b(s.Gifts,(_,w)=>(a(),o("div",{key:w,class:"gift-item"},[n("span",ne,f(_),1)]))),128))])])):g("",!0)],2)):g("",!0)],2))),128))])]))),128)),!l.value&&d.value?(a(),o("div",oe)):g("",!0),!l.value&&d.value&&c.value?(a(),o("div",ae,[...e[4]||(e[4]=[n("div",{class:"loading-spinner"},null,-1),n("span",null,"加载更多...",-1)])])):g("",!0),!l.value&&!d.value&&I.value.length>0?(a(),o("div",le,[...e[5]||(e[5]=[n("span",null,"已加载全部数据",-1)])])):g("",!0),I.value.length===0&&!c.value?(a(),o("div",re,[l.value?(a(),o("p",ie,'未找到 "'+f(l.value)+'" 相关的怪物',1)):(a(),o("p",ue,"暂无数据"))])):g("",!0)])]))}}),pe=R(ce,[["__scopeId","data-v-efee6613"]]);export{pe as default};
