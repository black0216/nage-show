import{d as x,r as c,h as E,o as P,a as z,i as M,w as F,c as i,b as s,j as O,v as R,k,F as U,e as G,t as w,n as $,l as p,g as B,f as r,_ as H}from"./index-DawpKkBg.js";import{I as A}from"./ItemTooltip-DbTG54MC.js";const J={class:"crafting-view"},K={class:"filters"},Q={class:"crafting-container"},W={class:"materials-section"},Z={class:"materials-grid"},ee={class:"material-container"},te=["onMouseenter","onMouseleave"],se=["alt"],ae={class:"item-name-label"},le={class:"material-container"},oe=["onMouseenter","onMouseleave"],ne=["alt"],ie={class:"item-name-label"},re={class:"material-container"},ue=["onMouseenter","onMouseleave"],ve=["alt"],me={class:"item-name-label"},de={class:"result-section"},ce={class:"result-container"},fe=["onMouseenter","onMouseleave"],Ie=["alt"],ge={class:"item-name-label"},he={key:0,class:"infinite-scroll-trigger",style:{height:"1px",width:"100%"}},_e={key:1,class:"loading-indicator"},we={key:2,class:"no-more"},ye={key:3,class:"no-results"},Ce={key:0},be={key:1},q=20,Me=x({__name:"CraftingView",setup(ke){let f=[];const m=c([]),o=c(""),I=c(null),g=c(""),S=c(1),h=c(!1),d=c(!0),N=async()=>{if(!(f.length>0))try{f=await(await fetch("/Crafting.json")).json()}catch(a){console.error("Failed to load all crafting data:",a)}},y=async(a=!1)=>{if(!h.value){h.value=!0;try{(a||m.value.length===0)&&(await N(),m.value=[],S.value=1,d.value=!0);const t=(S.value-1)*q,e=t+q,l=f.slice(t,e);a?m.value=l:m.value=[...m.value,...l],S.value++,d.value=e<f.length}catch(t){console.error("Failed to load crafting data:",t)}finally{h.value=!1}}},T=E(()=>o.value?f.filter(a=>{const t=o.value.toLowerCase();return a.Item.Name.toLowerCase().includes(t)||a.ItemA.Name.toLowerCase().includes(t)||a.ItemB.Name.toLowerCase().includes(t)||a.ItemC.Name.toLowerCase().includes(t)}):m.value);let L;const V=a=>{clearTimeout(L),L=setTimeout(async()=>{a?f.length===0&&await y(!0):(await y(!0),await M(),b())},300)},C=(a,t,e)=>{const n=`/images/${a.toLowerCase()}.jpg`,D=32,Y=-(e-1)*D,j=-(t-1)*D;return{width:"32px",height:"32px",backgroundImage:`url(${n})`,backgroundPosition:`${Y}px ${j}px`,backgroundSize:"256px 256px",backgroundRepeat:"no-repeat"}},_=(a,t,e)=>{const l=`${a.Name}_${a.Sheet}_${a.X}_${a.Y}_${a.Type}`;return t!==void 0&&e!==void 0?`${l}_${t}_${e}`:l},u=(a,t,e,l)=>{l?(I.value=a,g.value=_(a,t,e)):(I.value=null,g.value="")};P(async()=>{await N(),y(!0),X()});let v=null;const X=()=>{v=new IntersectionObserver(a=>{a.forEach(t=>{t.isIntersecting&&d.value&&!h.value&&!o.value&&y()})},{root:null,rootMargin:"200px",threshold:.1}),b(),z(()=>{v&&v.disconnect()})},b=()=>{v&&(v.disconnect(),M(()=>{if(v&&!o.value&&d.value){const a=document.querySelector(".infinite-scroll-trigger");a&&v.observe(a);const t=document.querySelector(".crafting-item:last-child");t&&v.observe(t)}}))};return F(()=>m.value.length,async()=>{await M(),b()}),F(()=>o.value,async(a,t)=>{t&&!a&&(await M(),b())}),(a,t)=>(r(),i("div",J,[t[10]||(t[10]=s("h1",null,"合成表",-1)),s("div",K,[O(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),onInput:t[1]||(t[1]=e=>V(o.value)),type:"text",placeholder:"搜索道具名称...",class:"search-input"},null,544),[[R,o.value]])]),s("div",Q,[(r(!0),i(U,null,G(T.value,(e,l)=>(r(),i("div",{key:l,class:"crafting-item"},[s("div",W,[t[5]||(t[5]=s("div",{class:"section-title"},"合成材料",-1)),s("div",Z,[s("div",ee,[t[2]||(t[2]=s("div",{class:"slot-label"},"A槽",-1)),s("div",{class:$(["item-wrapper",{equipment:e.ItemA.Type===3,gift:e.ItemA.Type===2}]),onMouseenter:n=>u(e.ItemA,l,"A",!0),onMouseleave:n=>u(e.ItemA,l,"A",!1)},[s("div",{class:"item-icon",style:B(C(e.ItemA.Sheet,e.ItemA.X,e.ItemA.Y)),alt:e.ItemA.Name},null,12,se),s("div",ae,w(e.ItemA.Name),1),p(A,{item:I.value,visible:g.value===_(e.ItemA,l,"A")},null,8,["item","visible"])],42,te)]),s("div",le,[t[3]||(t[3]=s("div",{class:"slot-label"},"B槽",-1)),s("div",{class:$(["item-wrapper",{equipment:e.ItemB.Type===3,gift:e.ItemB.Type===2}]),onMouseenter:n=>u(e.ItemB,l,"B",!0),onMouseleave:n=>u(e.ItemB,l,"B",!1)},[s("div",{class:"item-icon",style:B(C(e.ItemB.Sheet,e.ItemB.X,e.ItemB.Y)),alt:e.ItemB.Name},null,12,ne),s("div",ie,w(e.ItemB.Name),1),p(A,{item:I.value,visible:g.value===_(e.ItemB,l,"B")},null,8,["item","visible"])],42,oe)]),s("div",re,[t[4]||(t[4]=s("div",{class:"slot-label"},"C槽",-1)),s("div",{class:$(["item-wrapper",{equipment:e.ItemC.Type===3,gift:e.ItemC.Type===2}]),onMouseenter:n=>u(e.ItemC,l,"C",!0),onMouseleave:n=>u(e.ItemC,l,"C",!1)},[s("div",{class:"item-icon",style:B(C(e.ItemC.Sheet,e.ItemC.X,e.ItemC.Y)),alt:e.ItemC.Name},null,12,ve),s("div",me,w(e.ItemC.Name),1),p(A,{item:I.value,visible:g.value===_(e.ItemC,l,"C")},null,8,["item","visible"])],42,ue)])])]),t[7]||(t[7]=s("div",{class:"crafting-arrow"},[s("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M20 8L32 20L20 32",stroke:"#ffd700","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),s("div",de,[t[6]||(t[6]=s("div",{class:"section-title"},"合成结果",-1)),s("div",ce,[s("div",{class:$(["item-wrapper",{equipment:e.Item.Type===3,gift:e.Item.Type===2}]),onMouseenter:n=>u(e.Item,l,"Final",!0),onMouseleave:n=>u(e.Item,l,"Final",!1)},[s("div",{class:"item-icon result-icon",style:B(C(e.Item.Sheet,e.Item.X,e.Item.Y)),alt:e.Item.Name},null,12,Ie),s("div",ge,w(e.Item.Name),1),p(A,{item:I.value,visible:g.value===_(e.Item,l,"Final")},null,8,["item","visible"])],42,fe)])])]))),128)),!o.value&&d.value?(r(),i("div",he)):k("",!0),!o.value&&d.value&&h.value?(r(),i("div",_e,[...t[8]||(t[8]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"加载更多...",-1)])])):k("",!0),!o.value&&!d.value&&T.value.length>0?(r(),i("div",we,[...t[9]||(t[9]=[s("span",null,"已加载全部数据",-1)])])):k("",!0),T.value.length===0&&!h.value?(r(),i("div",ye,[o.value?(r(),i("p",Ce,'未找到 "'+w(o.value)+'" 相关的合成配方',1)):(r(),i("p",be,"暂无数据"))])):k("",!0)])]))}}),Be=H(Me,[["__scopeId","data-v-7c0e6a80"]]);export{Be as default};
